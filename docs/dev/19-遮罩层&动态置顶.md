# Dialog-Modal & 动态置顶

## 遮罩层 dialogModal
首先先设置 `modal` 元素的默认样式：
```css
/* renderer/styles/index.css */

.dialog-overlay {
  opacity: 0;
  transition: opacity 0.8s ease;
  position: fixed;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  width: 100%;
  height: 100%;
  z-index: 9999;
  &.show {
    opacity: 1;
  }
}
```
在钩子上根据明暗模式，添加不同的 bg-color，在 dialog 创建后挂载 modal，交互后移除 modal
```ts
// renderer/hooks/useDialog.ts

export function useDialog() {
    // vueuse
  const isDarkMode = usePreferredDark();

  const createDialog = (opts: CreateDialogProps) => {
    const overlay = document.createElement('div');
    const isModal = opts.isModal !== false;   // 默认展示遮罩层

    // 遮罩层样式
    overlay.classList.add('dialog-overlay');
    // 根据明暗，设置不同的bg-color
    watchEffect(() => overlay.style.backgroundColor = isDarkMode.value
      ? 'rgba(0, 0, 0, 0.6)'
      : 'rgba(255, 255, 255, 0.6)'
    );

    return new Promise<string>((resolve) => {

      // dialog交互后触发
      window.api.createDialog(opts).then(res => {
        resolve(res);
        if (!isModal) return;    // 没有遮罩层直接返回
        document.body.removeChild(overlay);   // 移除dom元素
        overlay?.classList?.remove('show');
      });

      // dialog创建后触发
      if (!isModal) return;
      document.body.appendChild(overlay);
      setTimeout(() => overlay.classList.add('show'), 10);
    });
  }
  return { createDialog }
}

export default useDialog;
```


## 动态置顶
给对话项设置动态菜单名 pinned or unpinned：
```ts
// conversationList/index.vue

// 对单个item的右键菜单操作
async function handleItemContextMenu(item: Conversation) {
  // 动态菜单（置顶）
  const clickItem = await createContextMenu(MENU_IDS.CONVERSATION_ITEM, void 0,
   item.pinned ? [{ label: 'menu.conversation.unpinConversation', id: CONVERSATION_ITEM_MENU_IDS.PIN }] : void 0) as CONVERSATION_ITEM_MENU_IDS;
  const action = conversationItemActionPolicy.get(clickItem);
  action && await action?.(item);
}

```